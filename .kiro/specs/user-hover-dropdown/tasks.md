# 实现计划：用户悬停下拉菜单

## 概述

将用户悬停下拉菜单作为独立 React 组件实现，然后集成到两个导航栏中，同时更新国际化资源。

## 任务

- [x] 1. 添加国际化资源
  - [x] 1.1 在 `src/lib/i18n.ts` 的英文资源中添加 `userDropdown.profile`、`userDropdown.myProjects`、`userDropdown.logout` 翻译键
    - _需求：6.1, 6.3_
  - [x] 1.2 在 `src/lib/i18n.ts` 的中文资源中添加对应的翻译键
    - _需求：6.1, 6.3_

- [x] 2. 创建 UserDropdown 组件
  - [x] 2.1 创建 `src/components/UserDropdown.tsx`，实现以下功能：
    - 接收 `user`（name, email, avatar）和 `onLogout` 属性
    - Trigger_Area：显示用户头像和名称，鼠标悬停触发面板
    - 面板分三个区域：用户信息区（头像+名称+邮箱）、快捷链接区（个人主页、我的项目，各带 SVG 图标）、退出登录区（带分隔线）
    - 使用 `isOpen` 状态和 150ms 延迟定时器控制显示/隐藏
    - 头像 `onError` 回调降级为默认头像
    - 使用 `useTranslation` 加载所有文本
    - 使用 Cinematic Luxury 设计系统样式（var(--ink-light)、var(--ink-border)、var(--gold) 等）
    - 面板使用 `animate-scale-in` 动画类
    - 组件卸载时清除定时器
    - _需求：1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 2.4, 3.1, 3.2, 3.3, 3.4, 4.1, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2_
  - [ ]* 2.2 编写属性测试：悬停开关往返一致性
    - **属性 1：悬停开关往返一致性**
    - **验证需求：1.1, 1.2**
  - [ ]* 2.3 编写属性测试：用户信息展示完整性
    - **属性 2：用户信息展示完整性**
    - **验证需求：2.1, 2.2, 2.3**
  - [ ]* 2.4 编写属性测试：链接点击关闭面板
    - **属性 3：链接点击关闭面板**
    - **验证需求：3.3**
  - [ ]* 2.5 编写属性测试：菜单项包含图标和国际化文本
    - **属性 4：菜单项包含图标和国际化文本**
    - **验证需求：3.4, 6.1, 6.2**
  - [ ]* 2.6 编写单元测试：边界情况
    - 测试未登录时不渲染组件
    - 测试退出按钮调用 onLogout
    - 测试头像加载失败降级为默认头像
    - 测试面板显示时包含 animate-scale-in 类名
    - _需求：1.4, 2.4, 4.2_

- [x] 3. 检查点 - 确保组件和测试正常
  - 确保所有测试通过，如有问题请向用户确认。

- [x] 4. 集成到导航栏
  - [x] 4.1 修改 `src/components/HeaderSimple.tsx`：导入 UserDropdown，替换已登录用户区域的头像链接和退出按钮为 `<UserDropdown>` 组件
    - _需求：4.3, 7.2, 7.3_
  - [x] 4.2 修改 `src/app/page.tsx`：导入 UserDropdown，替换首页导航栏中已登录用户区域的头像链接和退出按钮为 `<UserDropdown>` 组件
    - _需求：4.3, 7.2, 7.3_

- [x] 5. 最终检查点 - 确保所有测试通过
  - 确保所有测试通过，如有问题请向用户确认。

## 备注

- 标记 `*` 的任务为可选任务，可跳过以加快 MVP 进度
- 每个任务引用了具体的需求编号以便追溯
- 属性测试验证通用正确性属性，单元测试验证具体示例和边界情况
